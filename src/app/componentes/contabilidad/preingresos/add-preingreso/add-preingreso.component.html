<div class="content-header">
   <div class="container-fluid">
      <div class="row mt-5 justify-content-center text-center">
         <div class="col-sm-6 sombra cabecera border">
            <h5 class="font-weight-bold mt-2">Nueva Partida de Ingresos</h5>
         </div>
      </div>
   </div>
</div>

<div class="content">
   <div class="container-fluid">
      <div class="row justify-content-center">
         <div class="card card-body col-sm-6 detalle sombra">
            <form [formGroup]="preingForm">
               <div class="row">
                  <div class="form-group col-md-12 my-0 py-0">
                     <label class="form-label col-form-label-sm ml-2 my-0 py-0"> Partida del Clasificador
                        Presupuestario
                     </label>
                  </div>
               </div>

               <div class="form-group col-md-12 mt-1">
                  <div class="input-group input-group-sm">
                     <div class="input-group-prepend">
                        <button type="button" class="btn btn-primary btn-sm" data-toggle="modal"
                           data-target="#clasificadorModal" (click)="clasificadorModal()"><i class="fa fa-search"></i>
                           Buscar </button>
                     </div>
                     <input type="text" aria-label="First name" class="form-control col-sm-2 text-center"
                        formControlName="codpart" readonly>
                     <input type="text" aria-label="Last name" class="form-control" formControlName="nomcla" readonly>
                  </div>
               </div>

               <div class="form-group col-md-6 mt-1">
                  <div class="input-group input-group-sm mb-3">
                     <div class="input-group-prepend">
                        <span class="input-group-text font-weight-bold">CÃ³digo<sup class="green">*</sup></span>
                     </div>
                     <input type="text" class="form-control" formControlName="codpar" required minlength="14"
                        maxlength="14" [ngClass]="{'is-invalid': this.codpar.invalid && this.codpar.touched,
                        'is-valid': this.codpar.valid, '': this.codpar.untouched}">
                  </div>
               </div>

               <div class="form-group col-md-12 mt-1">
                  <div class="input-group input-group-sm mb-3">
                     <div class="input-group-prepend">
                        <span class="input-group-text font-weight-bold">Nombre<sup class="green">*</sup></span>
                     </div>
                     <input type="text" class="form-control" formControlName="nompar" required minlength="3" [ngClass]="{'is-invalid': this.nompar.invalid && this.nompar.touched,
                        'is-valid': this.nompar.valid, '': this.nompar.untouched}">
                  </div>
               </div>

               <div class="row justify-content-start col-md-12">
                  <div class="input-group input-group-sm mb-3 col-sm-5">
                     <div class="input-group-prepend">
                        <span class="input-group-text font-weight-bold ">Inicial</span>
                     </div>
                     <input type="text" class="form-control text-right" formControlName="inicia" min="0"
                        mask='separator.2'>
                  </div>
               </div>

               <div class="mt-2 mb-0 text-center">
                  <button type="button" class="btn btn-success btn-sm mb-1" [disabled]="!preingForm.valid"
                     (click)="onSubmit()">
                     <i class="fa fa-check-circle"></i> Aceptar</button>
                  <button class="btn btn-outline-success btn-sm mx-2 btn-sm mb-1" (click)="regresar()">
                     <i class="fa fa-times-circle"></i> Cancelar</button>
               </div>
            </form>
         </div>
      </div>
   </div>

   <!-- Modal Buscar Partida del Clasificador -->
   <div class="modal fade" id="clasificadorModal" tabindex="-1" aria-labelledby="clasificadorModalLabel"
      aria-hidden="true" data-backdrop="static">
      <div class="modal-dialog modal-lg modal-dialog-scrollable">
         <div class="modal-content">
            <div class="modal-body detalle">
               <div row class="ml-1 my-0">
                  <form [formGroup]="formBusClasificador" class="mb-0 cabecera">
                     <div class="row py-2">
                        <div class="input-group col-sm-8">
                           <input type="text" placeholder="Partida" class="form-control form-control-sm col-sm-2 ml-2"
                              autofocus formControlName="codpar" />
                           <input type="text" placeholder="Nombre" class="form-control form-control-sm text-center"
                              formControlName="nompar" />
                           <div class="input-group-append">
                              <button class="btn btn-sm btn-primary" (click)="buscarClasificador()">
                                 <i class="fa fa-search"></i> Buscar</button>
                           </div>
                        </div>
                        <div *ngIf="_clasificador" class="col-md-3 mr-2">
                           <input type="text" class="form-control form-control-sm text-center" formControlName="filtrar"
                              placeholder="Filtrar..." [(ngModel)]="filtro" />
                        </div>
                     </div>
                  </form>
               </div>
               <div class="row ml-1 mr-0">
                  <table *ngIf="_clasificador" class="table table-hover table-bordered table-sm mt-0 pt-0">
                     <thead class="cabecera pad0">
                        <tr>
                           <th></th>
                           <th class="col-sm-2">Partida</th>
                           <th class="col-sm-10">Nombre</th>
                        </tr>
                     </thead>
                     <tbody class="roboto small pad0">
                        <tr *ngFor="let partida of _clasificador  | filter: filtro; let i= index"
                           (click)="selecClasificador(partida)" data-dismiss="modal" class="filas">
                           <td class="text-center small font-weight-bold py-0">{{i+1}}</td>
                           <td class="py-0">{{ partida.codpar }}</td>
                           <td class="py-0">{{ partida.nompar }}</td>
                        </tr>
                     </tbody>
                  </table>
               </div>
            </div>
            <div class="modal-footer detalle">
               <button type="button" class="btn btn-sm btn-success" data-dismiss="modal">
                  <i class="bi bi-x-circle"></i> Cancelar</button>
            </div>
         </div>
      </div>
   </div>
</div>